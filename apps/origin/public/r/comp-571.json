{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "comp-571",
  "type": "registry:component",
  "registryDependencies": [
    "https://coss.com/origin/r/tree.json",
    "https://coss.com/origin/r/input.json"
  ],
  "files": [
    {
      "path": "registry/default/components/comp-571.tsx",
      "content": "\"use client\";\n\nimport {\n  expandAllFeature,\n  hotkeysCoreFeature,\n  searchFeature,\n  selectionFeature,\n  syncDataLoaderFeature,\n  type TreeState,\n} from \"@headless-tree/core\";\nimport { useTree } from \"@headless-tree/react\";\nimport { FolderIcon, FolderOpenIcon, SearchIcon } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { Input } from \"@/registry/default/ui/input\";\nimport { Tree, TreeItem, TreeItemLabel } from \"@/registry/default/ui/tree\";\n\ninterface Item {\n  name: string;\n  children?: string[];\n}\n\nconst items: Record<string, Item> = {\n  apis: { name: \"APIs\" },\n  backend: { children: [\"apis\", \"infrastructure\"], name: \"Backend\" },\n  company: {\n    children: [\"engineering\", \"marketing\", \"operations\"],\n    name: \"Company\",\n  },\n  components: { name: \"Components\" },\n  content: { name: \"Content\" },\n  \"design-system\": {\n    children: [\"components\", \"tokens\", \"guidelines\"],\n    name: \"Design System\",\n  },\n  engineering: {\n    children: [\"frontend\", \"backend\", \"platform-team\"],\n    name: \"Engineering\",\n  },\n  finance: { name: \"Finance\" },\n  frontend: { children: [\"design-system\", \"web-platform\"], name: \"Frontend\" },\n  guidelines: { name: \"Guidelines\" },\n  hr: { name: \"HR\" },\n  infrastructure: { name: \"Infrastructure\" },\n  marketing: { children: [\"content\", \"seo\"], name: \"Marketing\" },\n  operations: { children: [\"hr\", \"finance\"], name: \"Operations\" },\n  \"platform-team\": { name: \"Platform Team\" },\n  seo: { name: \"SEO\" },\n  tokens: { name: \"Tokens\" },\n  \"web-platform\": { name: \"Web Platform\" },\n};\n\nconst indent = 20;\n\nexport default function Component() {\n  // Store the initial expanded items to reset when search is cleared\n  const initialExpandedItems = [\"engineering\", \"frontend\", \"design-system\"];\n  const [state, setState] = useState<Partial<TreeState<Item>>>({});\n\n  const tree = useTree<Item>({\n    dataLoader: {\n      getChildren: (itemId) => items[itemId].children ?? [],\n      getItem: (itemId) => items[itemId],\n    },\n    features: [\n      syncDataLoaderFeature,\n      hotkeysCoreFeature,\n      selectionFeature,\n      searchFeature,\n      expandAllFeature,\n    ],\n    getItemName: (item) => item.getItemData().name,\n    indent,\n    initialState: {\n      expandedItems: initialExpandedItems,\n    },\n    isItemFolder: (item) => (item.getItemData()?.children?.length ?? 0) > 0,\n    rootItemId: \"company\",\n    setState,\n    state,\n  });\n\n  return (\n    <div className=\"flex h-full flex-col gap-2 *:nth-2:grow\">\n      <div className=\"relative\">\n        <Input\n          className=\"peer ps-9\"\n          {...{\n            ...tree.getSearchInputElementProps(),\n            onChange: (e) => {\n              // First call the original onChange handler from getSearchInputElementProps\n              const originalProps = tree.getSearchInputElementProps();\n              if (originalProps.onChange) {\n                originalProps.onChange(e);\n              }\n\n              // Then handle our custom logic\n              const value = e.target.value;\n\n              if (value.length > 0) {\n                // If input has at least one character, expand all items\n                tree.expandAll();\n              } else {\n                // If input is cleared, reset to initial expanded state\n                setState((prevState) => {\n                  return {\n                    ...prevState,\n                    expandedItems: initialExpandedItems,\n                  };\n                });\n              }\n            },\n          }}\n          placeholder=\"Quick search...\"\n          type=\"search\"\n        />\n        <div className=\"pointer-events-none absolute inset-y-0 start-0 flex items-center justify-center ps-3 text-muted-foreground/80 peer-disabled:opacity-50\">\n          <SearchIcon aria-hidden=\"true\" className=\"size-4\" />\n        </div>\n      </div>\n\n      <Tree indent={indent} tree={tree}>\n        {tree.getItems().map((item) => {\n          return (\n            <TreeItem item={item} key={item.getId()}>\n              <TreeItemLabel>\n                <span className=\"flex items-center gap-2\">\n                  {item.isFolder() &&\n                    (item.isExpanded() ? (\n                      <FolderOpenIcon className=\"pointer-events-none size-4 text-muted-foreground\" />\n                    ) : (\n                      <FolderIcon className=\"pointer-events-none size-4 text-muted-foreground\" />\n                    ))}\n                  {item.getItemName()}\n                </span>\n              </TreeItemLabel>\n            </TreeItem>\n          );\n        })}\n      </Tree>\n\n      <p\n        aria-live=\"polite\"\n        className=\"mt-2 text-muted-foreground text-xs\"\n        role=\"region\"\n      >\n        Tree with search highlight âˆ™{\" \"}\n        <a\n          className=\"underline hover:text-foreground\"\n          href=\"https://headless-tree.lukasbach.com\"\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n        >\n          API\n        </a>\n      </p>\n    </div>\n  );\n}\n",
      "type": "registry:component"
    }
  ],
  "meta": {
    "tags": [
      "tree",
      "filter",
      "search"
    ]
  }
}